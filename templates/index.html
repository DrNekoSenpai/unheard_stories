[[extend 'layout.html']]

<!-- vue access div -->
<div class="section" id="vue-target">
  <!-- add story html toggle block -->
  <div v-if="add_mode" class="container block">
    <!-- Title Input Field -->
    <div class="field">
      <label class="label">Title:</label>
      <div class="control">
        <input type="text" v-model="add_title" class="input" />
      </div>
    </div>

    <!-- Contents Input Field -->
    <div class="field">
      <label class="label">Contents:</label>
      <div class="control">
        <textarea v-model="add_content" class="textarea"></textarea>
      </div>
    </div>

    <!-- Author Input Field -->
    <div class="field">
      <label class="label">Author:</label>
      <div class="control">
        <input type="text" v-model="add_author" class="input" />
      </div>
    </div>

    <!-- Submit Button -->
    <div class="field">
      <div class="control">
        <input
          type="submit"
          @click="add_story"
          value="Add"
          class="button is-primary"
        />
        <input
          type="submit"
          @click="set_feed_mode()"
          value="Back"
          class="button is-warning"
        />
      </div>
    </div>
  </div>

  <!-- view story html toggle block -->
  <div v-if="view_mode" class="container block">
    <!-- Title -->
    <div class="block">
      <div class="title is-2">{{view_title}}</div>
    </div>
    <!-- details -->
    <div class="block">
      <div class="subtitle is-6">
        by {{view_author}}, Created on {{view_date}}
      </div>
    </div>
    <!-- content -->
    <div class="block">
      <div class="box">{{view_content}}</div>
    </div>
    <!-- Back Button -->
    <input
      type="submit"
      @click="set_feed_mode()"
      value="Back"
      class="button is-warning"
    />
  </div>

  <!-- feed html toggle block -->
  <div v-if="feed_mode" class="container block">
    <div class="title">Unheard Stories</div>
    <div class="container">
      <table class="table is-striped is-fullwidth">
        <!-- vue feed -->
        <div v-for="story in feed" class="block">
          <div class="box">
            <div class="columns">
              <div class="column is-11">
                <p><b>{{story.title}}</b></p>
                <p><i>by {{story.author}}</i></p>

                <!-- Display likes, dislikes, number of comments -->
                <p>
                  <span class="icon"><i class="fa fa-fw fa-heart"></i></span>
                  <span>{{story.likes}}</span>
                  <span class="icon"><i class="fa fa-fw fa-comments"></i></span>
                  <span>{{story.num_comments}}</span>
                </p>
              </div>

              <div class="column is-1">
                <!-- view button -->
                <a class="button is-success" @click="view(story._idx)">
                  <span class="icon"><i class="fa fa-fw fa-eye"></i></span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </table>
    </div>
    <a class="button is-success" @click="set_add_mode()">
      <span class="icon"><i class="fa fa-plus"></i></span>
      <span>Submit a story</span>
    </a>
  </div>
</div>

[[block page_scripts]]
<!-- This passes the python controller actions to the js -->
<script>
  let add_story_url = "[[=XML(add_story_url)]]";
  let get_feed_url = "[[=XML(get_feed_url)]]";
</script>
<script src="js/index.js"></script>
[[end]]
